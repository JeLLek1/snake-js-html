"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var segmentcss="snike__segment",mapWallHtml="<div class=\"snike__map snike__map--wall\"></div>",mapPathcHtml="<div class=\"snike__map snike__map--path\"></div>",clearFix="<div class=\"snike__sclearFix\"></div>",foodClass="snike__food",dir=[[-1,0],[0,-1],[1,0],[0,1]],Map=function(){function a(b){_classCallCheck(this,a),this.size_x=10,this.size_y=10,b.size_x&&(this.size_x=b.size_x),b.size_y&&(this.size_y=b.size_y)}return _createClass(a,[{key:"buildMap",value:function(){for(var a="",b=0;b<this.size_x+2;b++)a+=mapWallHtml;a+=clearFix;for(var b=0;b<this.size_y;b++){a+=mapWallHtml;for(var c=0;c<this.size_x;c++)a+=mapPathcHtml;a+=mapWallHtml,a+=clearFix}for(var b=0;b<this.size_x+2;b++)a+=mapWallHtml;return a+=clearFix,a}},{key:"returnWidth",value:function(){return this.size_x}},{key:"returnHeight",value:function(){return this.size_y}}]),a}(),Segment=function(){function a(b,c){_classCallCheck(this,a),this.el=document.createElement("div"),this.el.className=segmentcss,this.x,this.y,this.setPos(b,c)}return _createClass(a,[{key:"setPos",value:function(a,b){this.x=a,this.y=b}},{key:"changePos",value:function(a,b){this.x+=a,this.y+=b}},{key:"update",value:function(a){this.el.style.setProperty("left",a+a*this.x+"px"),this.el.style.setProperty("top",a+a*this.y+"px")}},{key:"returnEl",value:function(){return this.el}},{key:"returnX",value:function(){return this.x}},{key:"returnY",value:function(){return this.y}},{key:"remove",value:function(){this.el.remove()}}]),a}(),Food=function(){var b=Math.floor;function a(){_classCallCheck(this,a),this.el=document.createElement("div"),this.el.className=foodClass,this.x,this.y}return _createClass(a,[{key:"returnEl",value:function(){return this.el}},{key:"setPos",value:function(a,c){this.x=b(Math.random()*a),this.y=b(Math.random()*c)}},{key:"update",value:function(a){this.el.style.setProperty("left",a+a*this.x+"px"),this.el.style.setProperty("top",a+a*this.y+"px")}},{key:"returnX",value:function(){return this.x}},{key:"returnY",value:function(){return this.y}}]),a}(),Snike=function(){var b=Math.floor;function a(b,c,d,e){_classCallCheck(this,a),this.counter=d,this.segments=[],this.container=b,this.menu=c,this.startButton=c.querySelector("#snike_start"),this.elementWidth=20,this.interval,this.input,e.el_width&&(this.elementWidth=e.el_width),this.speed=500,e.speed&&(this.speed=e.speed),this.map=new Map(e),this.container.innerHTML=this.map.buildMap(),e.el_width&&document.documentElement.style.setProperty("--segment-width",e.el_width+"px"),this.food=new Food(this.map.returnWidth(),this.map.returnHeight()),this.eventListener()}return _createClass(a,[{key:"prepare",value:function(){this.input=0;for(var a=0;a<this.segments.length;a++)this.segments[a].remove();this.food.setPos(this.map.returnWidth(),this.map.returnHeight()),this.food.update(this.elementWidth),this.segments=[],this.container.appendChild(this.food.returnEl()),this.food.update(this.elementWidth),this.segments.push(new Segment(b(this.map.returnWidth()/2),b(this.map.returnHeight()/2))),this.container.appendChild(this.segments[0].returnEl()),this.segments[0].update(this.elementWidth),this.updateCounter()}},{key:"updateCounter",value:function(){this.counter.innerHTML=this.segments.length-1}},{key:"eventListener",value:function(){var a=this;window.addEventListener("keyup",function(b){switch(b.keyCode){case 37:2!=a.input&&(a.input=0);break;case 38:3!=a.input&&(a.input=1);break;case 39:0!=a.input&&(a.input=2);break;case 40:1!=a.input&&(a.input=3);}}),this.startButton.addEventListener("click",function(){a.start()})}},{key:"start",value:function(){this.prepare(),this.menu.className="snike_menu--hidden",this.loop()}},{key:"stop",value:function(){clearInterval(this.interval),this.menu.className="snike_menu"}},{key:"handeInput",value:function(){this.food.returnX()==this.segments[0].returnX()&&this.food.returnY()==this.segments[0].returnY()&&(this.segments.push(new Segment(this.segments[this.segments.length-1].returnX(),this.segments[this.segments.length-1].returnY())),this.container.appendChild(this.segments[this.segments.length-1].returnEl()),this.food.setPos(this.map.returnWidth(),this.map.returnHeight()),this.food.update(this.elementWidth),this.updateCounter());for(var a=this.segments.length-1;0<a;a--)this.segments[a].setPos(this.segments[a-1].returnX(),this.segments[a-1].returnY());this.segments[0].changePos(dir[this.input][0],dir[this.input][1])}},{key:"update",value:function(){for(var a=0;a<this.segments.length;a++)this.segments[a].update(this.elementWidth);for(var b=!1,a=1;a<this.segments.length;a++)this.segments[0].returnX()==this.segments[a].returnX()&&this.segments[0].returnY()==this.segments[a].returnY()&&(b=!0);(0>this.segments[0].returnX()||this.segments[0].returnX()>=this.map.returnWidth()||0>this.segments[0].returnY()||this.segments[0].returnY()>=this.map.returnHeight())&&(b=!0),b&&this.stop()}},{key:"loop",value:function(){var a=this;this.interval=window.setInterval(function(){a.handeInput(),a.update()},this.speed)}}]),a}(),snike=new Snike(document.querySelector("#snike"),document.querySelector("#snike_menu"),document.querySelector("#snike_counter"),{size_x:21,size_y:21,el_width:20,speed:120});